@using EntityLayer.Concrete
@model List<workOrder>
@{
	Layout = "~/Views/Shared/_Layout.cshtml";
}
<div class="row">
	<div class="col">
		<div class="card bg-default shadow">
			<div class="card-header bg-transparent border-0">
				<h3 class="text-white mb-0">İş Emirleri</h3>
			</div>
			<div class="table-responsive">
				<table class="table align-items-center table-dark table-flush">
					<thead class="thead-dark">
						<tr>
							<th scope="col" class="sort">#</th>
							<th scope="col" class="sort" data-sort="name">İş Emri</th>
							<th scope="col" class="sort" data-sort="name">İş Emri Başlangıç Tarihi</th>
							<th scope="col" class="sort" data-sort="name">İş emri alındı mı</th>
							<th scope="col" class="sort" data-sort="name">İş emri sonlandı mı</th>
							<th scope="col">İş Emri Raporu</th>
							<th scope="col">İş Emri Detayları</th>
							<th scope="col">Düzenle</th>
							<th scope="col">Sil</th>

						</tr>
					</thead>
					<tbody class="list">
						@foreach (var item in Model)
						{
							<tr>
								<th>@item.id</th>
								<th scope="row">
									<div class="media align-items-center">
										<div class="media-body">
											<span class="name mb-0 text-sm">@item.title</span>
										</div>
									</div>
								</th>
								<th scope="row">
									<div class="media align-items-center">
										<div class="media-body">
											<span class="name mb-0 text-sm">
												@(item.workOrderStartDate.HasValue
												? item.workOrderStartDate.Value.ToString("dd-MM-yyyy HH:mm:ss")
												: "Tarih Yok")
											</span>
										</div>
									</div>
								</th>
								<td>
									<span class="badge @((item.isOpened) ? "bg-success" : "bg-danger")">
										@((item.isOpened) ? "Evet" : "Hayır")
									</span>
								</td>
								<td>
									<span class="badge @((item.isClosed) ? "bg-success" : "bg-danger")">
										@((item.isClosed) ? "Evet" : "Hayır")
									</span>
								</td>
								<td><a href="/Work/WorkReports/@item.id" class="btn btn-outline-primary">İş Emri Raporları</a></td>
								<td><a href="/Work/WorkOrderDetails/@item.id" class="btn btn-outline-primary">İş Emri Detayları</a></td>
								<td><a href="/Work/EditWorkOrder/@item.id" class="btn btn-outline-success">Düzenle</a></td>
								<td><a href="/Work/RemoveWorkOrder/@item.id" class="btn btn-outline-warning">Sil</a></td>
							</tr>
						}
					</tbody>
				</table>

			</div>
		</div>
	</div>
</div>
<br />
<a href="/Work/AddWorkOrder/" class="btn btn-info"> Yeni İş Emri Ekle</a>
@{
	var swalMessage = TempData["SwalMessage"] as string;
	var swalType = TempData["SwalType"] as string;

	
}

@section Scripts {
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
	@if (!string.IsNullOrEmpty(swalMessage) && !string.IsNullOrEmpty(swalType))
	{
		// Mark TempData as read so it won't persist
		TempData.Remove("SwalMessage");
		TempData.Remove("SwalType");

		<script>
			Swal.fire({
				icon: '@swalType',
				title: 'Uyarı',
				text: '@Html.Raw(System.Text.Encodings.Web.JavaScriptEncoder.Default.Encode(swalMessage))',
				showConfirmButton: false,
				timer: 2500
			});
		</script>
	}
}

